#!/bin/sh
#
# Simple CGI script to generate a page with per-project
# message counts generated by the CIA bot.
#
STATDIR=/home/commits/stats

echo -ne "Content-type: text/html\n\n"

cat <<EOF
<html>
<head><title>CIA bot statistics</title></head>
<h1>CIA bot statistics</h1>
These values show the number of messages (generally commits) posted to the
CIA bot per project.
<p>
<table border=1>
<tr><td> Project </td><td> Messages</td></tr>
EOF

cd $STATDIR
(for file in *; do
  echo "<tr><td>" $file "</td><td>" `cat $file` "</td></tr>"
done) | sort -n -r +4

cat <<EOF
</table>
</p>
</html>
EOF
