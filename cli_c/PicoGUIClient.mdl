# -*- python -*-

import string

from Bee.Autoconf import compile, install, clean

multicompile = 1

depends = [ 'resourcemanager', 'picoguiserver' ]

runtime = [
    Runtime ('libpgui.so', 'PicoGUI client shared library',
             content = ['lib/libpgui.so.0.0.0',
                        'lib/libpgui.so.0',
                        'lib/libpgui.so'])
    ]

def prepare (module, platform, project):
    command = [
        "../configure --prefix=/",
        "--enable-bee",
        "--enable-unix-sockets ",
        "--with-prefix=%s" % platform.toolchain,
        "--host=%s" % platform.platform,
        "--with-pgserver=%s" % project ['module/picoguiserver'].path ['dfl']
        ]

    command = string.join (command)
    
    message  ("running: %s" % command)
    sequence ("rm -f config.status ; test ! -f ../autogen.sh || (cd .. ; ./autogen.sh || true)",
              command)
    return

